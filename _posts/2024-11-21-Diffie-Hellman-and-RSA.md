---
layout: post
title: "Diffie-Hellman and RSA"
description: ""
date: 2024-11-21
feature_image: images/cryptography.png
tags: ['cryptography', 'security', 'discrete-mathematics']
---

Diffie-Hellman and RSA are two popular algorithms for secure communication. They fixed the problem of former cryptography, which was the key distribution problem and digital signature problem based on number theory.

<!--more-->

## Table of Contents

- [Problems of former cryptography](#problems-of-former-cryptography)
  - [Key Distribution Problem](#key-distribution-problem)
  - [Digital Signature Problem](#digital-signature-problem)
- [Introduction of Diffie-Hellman and RSA](#introduction-of-diffie-hellman-and-rsa)
- [Elliptic Curve Cryptography](#elliptic-curve-cryptography)
  - [Known Subexponential Algorithms](#known-subexponential-algorithms)
  - [Elliptic Curve Cryptography (ECC)](#elliptic-curve-cryptography-ecc)
  - [Summary](#summary)

---

# Problems of former cryptography

## Key Distribution Problem

In traditional symmetric encryption systems, both communicating parties need to share a secret key. This key must be securely distributed to all message senders and receivers before communication begins. However, this key distribution process has the following issues:

- **Security Issues**: If the key is intercepted during transmission, the security of the entire communication will be severely compromised.
- **Management Complexity**: As the number of users increases, the number of keys that need to be managed grows exponentially. For example, if there are \( n \) users, each pair of users requires an independent key, resulting in a total of \( \frac{n(n-1)}{2} \) keys that need to be managed.
- **Initial Trust Issue**: How to securely distribute keys in the absence of pre-established trust is a significant challenge.

Public-key cryptography addresses these issues by introducing a pair of keysâ€”public and private keys:

- **Public Key**: Can be publicly distributed and used for encrypting data or verifying signatures.
- **Private Key**: Must be kept confidential and used for decrypting data or generating signatures.

Through this method, communication parties can securely exchange information over an insecure channel without needing to share any secret information in advance. For example, Alice can use Bob's public key to encrypt a message, and then Bob can use his own private key to decrypt the message. Thus, even if the message is intercepted during transmission, the attacker cannot decrypt it without the private key.

<iframe src="https://www.desmos.com/calculator/cl8ry2a8yq?embed" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>

## Digital Signature Problem

In the era of paper documents, signatures were a common way to verify the authenticity of documents. However, the advent of electronic documents has brought new challenges:

- **Non-repudiation**: How to ensure that electronic signatures cannot be denied?
- **Integrity**: How to ensure that electronic documents have not been tampered with during transmission?
- **Authentication**: How to ensure that the electronic signature was indeed generated by a specific person?

Public-key cryptography solves these problems through digital signature technology:

- **Signature Generation**: The sender uses their own private key to sign the hash value of the message, generating a digital signature.
- **Signature Verification**: The receiver uses the sender's public key to verify the digital signature. If the signature verification is successful, the receiver can be confident that:
  - The message was indeed generated by the claimed sender.
  - The message has not been altered during transmission.
  - The sender cannot deny sending the message.

---

# Introduction of Diffie-Hellman and RSA

The Diffie-Hellman key exchange protocol (often abbreviated as Diffie-Hellman or DH) is a security protocol that allows two parties to establish a shared secret over an insecure communication channel. This shared secret can be used to encrypt subsequent communications. The protocol was proposed by Whitfield Diffie and Martin Hellman in 1976 and is the first widely used key exchange algorithm.

At the same year, Whitfield Diffie and Martin Hellman introduced the concept of public-key cryptography, demonstrating the possibility of public-key cryptography. They proposed a framework where two communicating parties can negotiate a shared key over an insecure channel without having to exchange any secret information in advance.

However, at the time, Diffie and Hellman did not immediately propose a specific, practical implementation of public-key cryptography. Instead, they issued a challenge to their colleagues, hoping that someone could come up with a feasible solution. This challenge was answered in 1977 by three researchers from MIT: Ron Rivest, Adi Shamir, and Leonard Adleman. They invented a public-key encryption algorithm based on number theory, known as the RSA algorithm. The name RSA comes from the initials of the three inventors.

| Feature                | Diffie-Hellman Key Exchange Protocol     | RSA Algorithm                                       |
| ---------------------- | ---------------------------------------- | --------------------------------------------------- |
| Main Function          | Negotiate shared key                     | Data encryption and digital signatures              |
| Application Scenario   | Session key negotiation                  | Data encryption, signature verification             |
| Dynamism               | Generates new key for each communication | Keys can be used long-term                          |
| Security               | Vulnerable to man-in-the-middle attacks  | Based on the difficulty of factoring large integers |
| Forward Secrecy        | Provides forward secrecy                 | Does not provide forward secrecy                    |
| Computational Overhead | Low                                      | High                                                |
| Applicable Scenarios   | Key negotiation over insecure networks   | Scenarios requiring long-term security              |

---

# Elliptic Curve Cryptography

This section provides an overview of Elliptic Curve Cryptography (ECC), a cryptographic algorithm that uses elliptic curve points for key exchange and public-key encryption. We will not focus on the mathematical details, but instead provide a high-level overview of the algorithm and its applications.

## Known Subexponential Algorithms

- **RSA and Diffie-Hellman**:
  - There are known subexponential (but superpolynomial) algorithms for breaking RSA and Diffie-Hellman.
  - For RSA, the most effective known attack is the General Number Field Sieve (GNFS).
  - For Diffie-Hellman, the Index Calculus Method is a known subexponential algorithm.

## Elliptic Curve Cryptography (ECC)

- **Advantages of ECC**:
  - No known subexponential algorithms for breaking ECC.
  - ECC is more secure for a given key size compared to other forms of cryptography.
  - Example: A 256-bit ECC key provides security equivalent to a 3072-bit RSA key.

- **ECC Diffie-Hellman (ECDH)**:
  - Key exchange protocol using elliptic curve points.
  - Example: Alice and Bob use elliptic curve point multiplication to negotiate a shared secret key.

- **ECC ElGamal (EC-ElGamal)**:
  - Public key encryption algorithm using elliptic curve points.
  - Example: Alice uses Bob's public key to encrypt a message, and Bob uses his private key to decrypt it.

- **Other ECC-Based Schemes**:
  - **Elliptic Curve Digital Signature Algorithm (ECDSA)**: Efficient and secure digital signatures.
  - **Elliptic Curve Key Encapsulation Mechanism (ECKEM)**: Securely encapsulates and decapsulates symmetric keys.

## Summary

| Feature               | RSA and Diffie-Hellman                     | Elliptic Curve Cryptography (ECC)                        |
| --------------------- | ------------------------------------------ | -------------------------------------------------------- |
| Known Attacks         | Subexponential (GNFS, Index Calculus)      | None known (subexponential)                              |
| Security for Key Size | Less secure for smaller key sizes          | More secure for smaller key sizes                        |
| Efficiency            | Higher computational overhead              | Lower computational overhead                             |
| Applications          | Widely used in SSL/TLS, digital signatures | Widely used in SSL/TLS, digital signatures, key exchange |